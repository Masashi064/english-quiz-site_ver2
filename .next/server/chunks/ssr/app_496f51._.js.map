{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/mkawa/myproject/english-quiz-site/app/components/FilterSidebar.tsx"],"sourcesContent":["'use client';\r\n\r\ntype Props = {\r\n  category: string;\r\n  setCategory: (v: string) => void;\r\n  channel: string;\r\n  setChannel: (v: string) => void;\r\n  level: string;\r\n  setLevel: (v: string) => void;\r\n  completion: string;\r\n  setCompletion: (v: string) => void;\r\n  allCategories: string[];\r\n  allChannels: string[];\r\n};\r\n\r\nexport default function FilterSidebar({\r\n  category,\r\n  setCategory,\r\n  channel,\r\n  setChannel,\r\n  level,\r\n  setLevel,\r\n  completion,\r\n  setCompletion,\r\n  allCategories,\r\n  allChannels,\r\n}: Props) {\r\n  const resetFilters = () => {\r\n    setCategory('all');\r\n    setChannel('all');\r\n    setLevel('all');\r\n    setCompletion('all');\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-4 p-4 text-sm text-black dark:text-white\">\r\n      <div>\r\n        <label className=\"block font-semibold mb-1\">Channel</label>\r\n        <select\r\n          className=\"w-full bg-white dark:bg-gray-800 border dark:border-gray-600 text-black dark:text-white\"\r\n          value={channel}\r\n          onChange={(e) => setChannel(e.target.value)}\r\n        >\r\n          <option value=\"all\">All Channels</option>\r\n          {allChannels.map((c) => (\r\n            <option key={c} value={c}>\r\n              {c}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      <div>\r\n        <label className=\"block font-semibold mb-1\">Category</label>\r\n        <select\r\n          className=\"w-full bg-white dark:bg-gray-800 border dark:border-gray-600 text-black dark:text-white\"\r\n          value={category}\r\n          onChange={(e) => setCategory(e.target.value)}\r\n        >\r\n          <option value=\"all\">All Categories</option>\r\n          {allCategories.map((c) => (\r\n            <option key={c} value={c}>\r\n              {c}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      <div>\r\n        <label className=\"block font-semibold mb-1\">Level</label>\r\n        <select\r\n          className=\"w-full bg-white dark:bg-gray-800 border dark:border-gray-600 text-black dark:text-white\"\r\n          value={level}\r\n          onChange={(e) => setLevel(e.target.value)}\r\n        >\r\n          <option value=\"all\">All Levels</option>\r\n          <option value=\"beginner\">Beginner</option>\r\n          <option value=\"intermediate\">Intermediate</option>\r\n          <option value=\"advanced\">Advanced</option>\r\n        </select>\r\n      </div>\r\n\r\n      <div>\r\n        <label className=\"block font-semibold mb-1\">Completion</label>\r\n        <select\r\n          className=\"w-full bg-white dark:bg-gray-800 border dark:border-gray-600 text-black dark:text-white\"\r\n          value={completion}\r\n          onChange={(e) => setCompletion(e.target.value)}\r\n        >\r\n          <option value=\"all\">All Quizzes</option>\r\n          <option value=\"completed\">Completed</option>\r\n          <option value=\"uncompleted\">Yet to try</option>\r\n        </select>\r\n      </div>\r\n\r\n      <button\r\n        onClick={resetFilters}\r\n        className=\"mt-4 w-full px-4 py-2 rounded bg-gray-300 text-gray-900 dark:bg-gray-600 dark:text-white hover:bg-gray-400 dark:hover:bg-gray-500\"\r\n      >\r\n        Reset Filters\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAee,SAAS,cAAc,EACpC,QAAQ,EACR,WAAW,EACX,OAAO,EACP,UAAU,EACV,KAAK,EACL,QAAQ,EACR,UAAU,EACV,aAAa,EACb,aAAa,EACb,WAAW,EACL;IACN,MAAM,eAAe;QACnB,YAAY;QACZ,WAAW;QACX,SAAS;QACT,cAAc;IAChB;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;;kCACC,8OAAC;wBAAM,WAAU;kCAA2B;;;;;;kCAC5C,8OAAC;wBACC,WAAU;wBACV,OAAO;wBACP,UAAU,CAAC,IAAM,WAAW,EAAE,MAAM,CAAC,KAAK;;0CAE1C,8OAAC;gCAAO,OAAM;0CAAM;;;;;;4BACnB,YAAY,GAAG,CAAC,CAAC,kBAChB,8OAAC;oCAAe,OAAO;8CACpB;mCADU;;;;;;;;;;;;;;;;;0BAOnB,8OAAC;;kCACC,8OAAC;wBAAM,WAAU;kCAA2B;;;;;;kCAC5C,8OAAC;wBACC,WAAU;wBACV,OAAO;wBACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;;0CAE3C,8OAAC;gCAAO,OAAM;0CAAM;;;;;;4BACnB,cAAc,GAAG,CAAC,CAAC,kBAClB,8OAAC;oCAAe,OAAO;8CACpB;mCADU;;;;;;;;;;;;;;;;;0BAOnB,8OAAC;;kCACC,8OAAC;wBAAM,WAAU;kCAA2B;;;;;;kCAC5C,8OAAC;wBACC,WAAU;wBACV,OAAO;wBACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;;0CAExC,8OAAC;gCAAO,OAAM;0CAAM;;;;;;0CACpB,8OAAC;gCAAO,OAAM;0CAAW;;;;;;0CACzB,8OAAC;gCAAO,OAAM;0CAAe;;;;;;0CAC7B,8OAAC;gCAAO,OAAM;0CAAW;;;;;;;;;;;;;;;;;;0BAI7B,8OAAC;;kCACC,8OAAC;wBAAM,WAAU;kCAA2B;;;;;;kCAC5C,8OAAC;wBACC,WAAU;wBACV,OAAO;wBACP,UAAU,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,KAAK;;0CAE7C,8OAAC;gCAAO,OAAM;0CAAM;;;;;;0CACpB,8OAAC;gCAAO,OAAM;0CAAY;;;;;;0CAC1B,8OAAC;gCAAO,OAAM;0CAAc;;;;;;;;;;;;;;;;;;0BAIhC,8OAAC;gBACC,SAAS;gBACT,WAAU;0BACX;;;;;;;;;;;;AAKP"}},
    {"offset": {"line": 235, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 241, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/mkawa/myproject/english-quiz-site/app/components/TopArticleList.tsx"],"sourcesContent":["'use client'\r\nimport { useEffect, useState } from 'react'\r\nimport Image from 'next/image'\r\nimport Link from 'next/link'\r\nimport FilterSidebar from '../components/FilterSidebar'\r\nimport { FaFilter } from 'react-icons/fa'\r\nimport { getAuth } from 'firebase/auth'\r\nimport { getFirestore, collection, getDocs } from 'firebase/firestore'\r\nimport { app } from '../../lib/firebase'\r\nimport { useAuth } from '../../lib/useAuth'\r\n\r\ntype Article = {\r\n  slug: string\r\n  movie_title: string\r\n  channel_name: string\r\n  movie_url: string\r\n  thumbnail_url: string\r\n  duration: string\r\n  published_at: string\r\n  published_date?: string\r\n  assigned_category?: string\r\n  assigned_level?: string\r\n  completed?: boolean\r\n}\r\n\r\nconst parseDuration = (iso: string): number => {\r\n  const match = iso.match(/PT(?:(\\d+)H)?(?:(\\d+)M)?(?:(\\d+)S)?/)\r\n  if (!match) return 0\r\n  const [, h, m, s] = match.map(Number)\r\n  return (h || 0) * 3600 + (m || 0) * 60 + (s || 0)\r\n}\r\n\r\nconst formatDuration = (iso: string): string => {\r\n  const seconds = parseDuration(iso)\r\n  const m = Math.floor(seconds / 60)\r\n  const s = seconds % 60\r\n  return `${m}:${s.toString().padStart(2, '0')} min`\r\n}\r\n\r\nconst formatDate = (iso: string): string => {\r\n  return new Date(iso).toLocaleDateString()\r\n}\r\n\r\nexport default function TopArticleList({ articles }: { articles: Article[] }) {\r\n  const [category, setCategory] = useState('all')\r\n  const [channel, setChannel] = useState('all')\r\n  const [level, setLevel] = useState('all')\r\n  const [completion, setCompletion] = useState('all')\r\n  const [drawerOpen, setDrawerOpen] = useState(false)\r\n  const [completedSlugs, setCompletedSlugs] = useState<string[]>([])\r\n  const [loadedCompletion, setLoadedCompletion] = useState(false)\r\n\r\n  const handleDrawerToggle = () => setDrawerOpen((prev) => !prev)\r\n\r\n  // TopArticleList.tsx ã‚ˆã‚Šè©²å½“ç®‡æ‰€ã‚’ä¿®æ­£\r\n  useEffect(() => {\r\n    const fetchCompleted = async () => {\r\n      const auth = getAuth(app)\r\n      const user = auth.currentUser\r\n      if (!user) return\r\n\r\n      const db = getFirestore(app)\r\n      const ref = collection(db, 'users', user.uid, 'quizResults')\r\n      const snapshot = await getDocs(ref)\r\n\r\n      const slugs = snapshot.docs\r\n        .filter(doc => doc.data().score > 0)\r\n        .map(doc => doc.id)\r\n\r\n      setCompletedSlugs(slugs)\r\n    }\r\n\r\n    if (completion !== 'all') {\r\n      fetchCompleted()\r\n    }\r\n  }, [completion])\r\n\r\n\r\n  const allCategories = Array.from(new Set(articles.map((a) => a.assigned_category).filter(Boolean))) as string[]\r\n  const allChannels = Array.from(new Set(articles.map((a) => a.channel_name)))\r\n\r\n  const filtered = articles\r\n    .map((a) => ({\r\n      ...a,\r\n      completed: completedSlugs.includes(a.slug),\r\n    }))\r\n    .filter((a) => {\r\n      const matchCategory = category === 'all' || a.assigned_category === category\r\n      const matchLevel = level === 'all' || a.assigned_level === level\r\n      const matchChannel = channel === 'all' || a.channel_name === channel\r\n      const matchCompletion =\r\n        completion === 'all' ||\r\n        (completion === 'completed' && a.completed) ||\r\n        (completion === 'uncompleted' && !a.completed)\r\n\r\n      return matchCategory && matchLevel && matchChannel && matchCompletion\r\n    })\r\n\r\n  const sorted = [...filtered].sort((a, b) => {\r\n    const aDate = new Date(a.published_date || a.published_at).getTime()\r\n    const bDate = new Date(b.published_date || b.published_at).getTime()\r\n    return bDate - aDate\r\n  })\r\n\r\n  return (\r\n    <main className=\"flex max-w-7xl mx-auto\">\r\n      {/* PC sidebar */}\r\n      <aside className=\"hidden md:block w-64 border-r bg-gray-50 dark:bg-black\">\r\n        <FilterSidebar\r\n          category={category}\r\n          setCategory={setCategory}\r\n          channel={channel}\r\n          setChannel={setChannel}\r\n          level={level}\r\n          setLevel={setLevel}\r\n          completion={completion}\r\n          setCompletion={setCompletion}\r\n          allCategories={allCategories}\r\n          allChannels={allChannels}\r\n        />\r\n      </aside>\r\n\r\n      {/* Mobile Drawer */}\r\n      {drawerOpen && (\r\n        <div className=\"fixed inset-0 z-50\">\r\n          <div className=\"absolute inset-0 bg-black/50\" onClick={() => setDrawerOpen(false)} />\r\n          <div\r\n            className=\"absolute top-0 left-0 w-64 h-full bg-white dark:bg-gray-900 p-4 overflow-y-auto\"\r\n            onClick={(e) => e.stopPropagation()}\r\n          >\r\n            <FilterSidebar\r\n              category={category}\r\n              setCategory={setCategory}\r\n              channel={channel}\r\n              setChannel={setChannel}\r\n              level={level}\r\n              setLevel={setLevel}\r\n              completion={completion}\r\n              setCompletion={setCompletion}\r\n              allCategories={allCategories}\r\n              allChannels={allChannels}\r\n            />\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Mobile Filter Button */}\r\n      <button\r\n        onClick={handleDrawerToggle}\r\n        className=\"fixed bottom-6 right-6 z-40 bg-blue-600 text-white p-4 rounded-full shadow-lg md:hidden\"\r\n        aria-label=\"Open filter drawer\"\r\n      >\r\n        <FaFilter size={24} />\r\n      </button>\r\n\r\n      <section className=\"flex-1 px-4 py-6\">\r\n        <h1 className=\"text-2xl font-bold mb-6\">ðŸ“… Newest Articles First</h1>\r\n        <div className=\"grid md:grid-cols-2 gap-6\">\r\n          {sorted.map((a, index) => (\r\n            <Link\r\n              key={a.slug}\r\n              href={`/article/${a.slug}`}\r\n              className=\"block border rounded shadow hover:shadow-lg overflow-hidden bg-white dark:bg-gray-900\"\r\n            >\r\n              <div className=\"relative w-full aspect-video\">\r\n                <Image\r\n                  src={`/img/img-${a.slug}.webp`}\r\n                  alt={a.movie_title}\r\n                  fill\r\n                  sizes=\"(max-width: 768px) 100vw, (max-width: 1024px) 50vw, 33vw\"\r\n                  priority={index === 0}\r\n                  className=\"object-cover\"\r\n                />\r\n              </div>\r\n              <div className=\"p-4\">\r\n                <h3 className=\"font-semibold text-lg mb-1\">{a.movie_title}</h3>\r\n                <p className=\"text-sm text-gray-500 dark:text-gray-300\">Channel: {a.channel_name}</p>\r\n                <p className=\"text-sm mt-1\">\r\n                  ðŸ•’ {formatDuration(a.duration)} / ðŸ“… {formatDate(a.published_date || a.published_at)}\r\n                </p>\r\n                <span className=\"inline-block mt-3 text-blue-600 dark:text-blue-400 font-semibold hover:underline\">\r\n                  â–¶ Read article\r\n                </span>\r\n              </div>\r\n            </Link>\r\n          ))}\r\n        </div>\r\n      </section>\r\n    </main>\r\n  )\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 518, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}